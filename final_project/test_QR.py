import QR

def test_stable_gram_schmidt():
    matrix1 = [[1, 0, 1], [2, 1, 0]]
    matrix2 = [[4,3],[5,6]]
    assert QR.stable_Gram_Schmidt(matrix1) == [[[0.7071067811865475, 0.0, 0.7071067811865475], [(0.577350269189626+0j), (0.5773502691896258+0j), (-0.5773502691896257+0j)]], [[1.4142135623730951, (1.414213562373095+0j)], [0, (1.7320508075688772+0j)]]]
    assert QR.stable_Gram_Schmidt(matrix2) == [[[0.8, 0.6000000000000001], [(-0.6000000000000008+0j), (0.7999999999999996+0j)]], [[5.0, (7.6000000000000005+0j)], [0, (1.7999999999999994+0j)]]]

def test_orthonormal_vectors():
    matrix1 = [[5,12],[15,25]]
    matrix2 = [[7,14],[20,27]]
    assert QR.orthonormal_vectors(matrix1) == [[0.38461538461538464, 0.9230769230769231], [(0.9230769230769229+0j), (-0.384615384615385+0j)]]
    assert QR.orthonormal_vectors(matrix2) == [[0.4472135954999579, 0.8944271909999159], [(0.8944271909999157+0j), (-0.4472135954999582+0j)]]
    
def test_householder_ortho():
    matrix1 = [[2,2,1],[-2,1,2],[1,3,1]]
    matrix2 = [[1,2,3],[3,2,1],[2,1,3]]
    assert QR.householder_ortho(matrix1) == [[[(0.6666666666666667+0j), (0.6666666666666666+0j), (0.3333333333333333+0j)], [(-0.7396002616336387+0j), (0.6471502289294337+0j), (0.18490006540840964+0j)], [(-0.09245003270420477+0j), (-0.3698001308168195+0j), (0.9245003270420487+0j)]], [[(0.33333333333333354+0j), (3+0j), (2.3333333333333335+0j)], [(-2.5886009157177354+0j), (-0.27735009811261446+0j), (0.7396002616336386+0j)], [(1.4792005232672785+0j), (2.2188007849009166+0j), (0.09245003270420477+0j)]]]
    assert QR.householder_ortho(matrix2) == [[[(0.2672612419124244+0j), (0.5345224838248488+0j), (0.8017837257372732+0j)], [(0.7246278635248041+0j), (0.4369928535473051+0j), (-0.5328711902064713+0j)], [(-0.6352053903855872+0j), (0.7234106442638908+0j), (-0.27053863271406486+0j)]], [[(3.474396144861517+0j), (2.4053511772118195+0j), (3.7416573867739413+0j)], [(0.9698640437537766+0j), (1.790370243937747+0j), (1.0122628735023032+0j)], [(0.9939492769779554+0j), (-0.0941281249574577+0j), (-1.9938214250350657+0j)]]]

